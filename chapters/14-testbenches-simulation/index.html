
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Verification and simulation techniques for validating Verilog digital designs before hardware implementation">
      
      
        <meta name="author" content="Dan McCreary">
      
      
        <link rel="canonical" href="https://dmccreary.github.io/digital-electronics/chapters/14-testbenches-simulation/">
      
      
        <link rel="prev" href="../13-verilog-modeling/references/">
      
      
        <link rel="next" href="quiz/">
      
      
      <link rel="icon" href="../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.43">
    
    
      
        <title>Testbenches and Simulation - Digital Electronics</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-E7S8QWP8T0"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-E7S8QWP8T0",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-E7S8QWP8T0",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="maroon" data-md-color-accent="gold">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#testbenches-and-simulation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Digital Electronics" class="md-header__button md-logo" aria-label="Digital Electronics" data-md-component="logo">
      
  <img src="../../img/logo.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Digital Electronics
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Testbenches and Simulation
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/dmccreary/digital-electronics" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub Repo
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Digital Electronics" class="md-nav__button md-logo" aria-label="Digital Electronics" data-md-component="logo">
      
  <img src="../../img/logo.jpg" alt="logo">

    </a>
    Digital Electronics
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/dmccreary/digital-electronics" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub Repo
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../course-description/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Course Description
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Chapters
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Chapters
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../01-number-systems-binary-arithmetic/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    1. Number Systems
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../02-boolean-algebra-fundamentals/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    2. Boolean Algebra
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../03-logic-gates-digital-signals/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    3. Logic Gates
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../04-combinational-logic-design/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    4. Combinational Design
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../05-logic-minimization-kmaps/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    5. K-Maps
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../06-combinational-building-blocks/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    6. Building Blocks
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../07-intro-sequential-logic/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    7. Sequential Logic
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../08-flip-flops-timing/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    8. Flip-Flops
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../09-fsm-fundamentals/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    9. FSM Fundamentals
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../10-fsm-design-applications/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    10. FSM Applications
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../11-registers-counters-datapath/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    11. Registers & Counters
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../12-verilog-hdl-fundamentals/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    12. Verilog Basics
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../13-verilog-modeling/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    13. Verilog Modeling
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_15" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="./" class="md-nav__link md-nav__link--active">
              
  
  <span class="md-ellipsis">
    14. Testbenches
  </span>
  

            </a>
            
              
              <label class="md-nav__link md-nav__link--active" for="__nav_4_15" id="__nav_4_15_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_15_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_15">
            <span class="md-nav__icon md-icon"></span>
            14. Testbenches
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="quiz/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quiz
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="references/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Annotated References
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../15-fpga-lab-skills/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    15. FPGA & Lab
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../lessons/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Lessons
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
      
        
          
        
      
        
          
        
      
        
          
        
      
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../sims/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Sims
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../learning-graph/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Learning Graph
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../prompts/equation-standards/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Prompts
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glossary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Glossary
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-we-built-this-site/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How we built this site
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contact/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contact
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#concepts-covered" class="md-nav__link">
    <span class="md-ellipsis">
      Concepts Covered
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction-trust-but-verify" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction: Trust, But Verify
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-a-testbench" class="md-nav__link">
    <span class="md-ellipsis">
      What Is a Testbench?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="What Is a Testbench?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#diagram-testbench-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Diagram: Testbench Architecture
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stimulus-generation-feeding-the-beast" class="md-nav__link">
    <span class="md-ellipsis">
      Stimulus Generation: Feeding the Beast
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Stimulus Generation: Feeding the Beast">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#diagram-stimulus-pattern-generator" class="md-nav__link">
    <span class="md-ellipsis">
      Diagram: Stimulus Pattern Generator
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clock-generation-the-heartbeat" class="md-nav__link">
    <span class="md-ellipsis">
      Clock Generation: The Heartbeat
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Clock Generation: The Heartbeat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#diagram-clock-waveform-generator" class="md-nav__link">
    <span class="md-ellipsis">
      Diagram: Clock Waveform Generator
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test-vectors-organized-test-data" class="md-nav__link">
    <span class="md-ellipsis">
      Test Vectors: Organized Test Data
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#self-checking-testbenches-automation-is-your-friend" class="md-nav__link">
    <span class="md-ellipsis">
      Self-Checking Testbenches: Automation Is Your Friend
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Self-Checking Testbenches: Automation Is Your Friend">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#diagram-self-checking-testbench-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Diagram: Self-Checking Testbench Flow
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simulation-running-your-design-without-hardware" class="md-nav__link">
    <span class="md-ellipsis">
      Simulation: Running Your Design (Without Hardware)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simulation-time-understanding-the-delay" class="md-nav__link">
    <span class="md-ellipsis">
      Simulation Time: Understanding the # Delay
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Simulation Time: Understanding the # Delay">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#diagram-simulation-time-visualization" class="md-nav__link">
    <span class="md-ellipsis">
      Diagram: Simulation Time Visualization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#waveform-viewer-seeing-is-believing" class="md-nav__link">
    <span class="md-ellipsis">
      Waveform Viewer: Seeing Is Believing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Waveform Viewer: Seeing Is Believing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#diagram-waveform-viewer-interface" class="md-nav__link">
    <span class="md-ellipsis">
      Diagram: Waveform Viewer Interface
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#debugging-waveforms-finding-the-bug" class="md-nav__link">
    <span class="md-ellipsis">
      Debugging Waveforms: Finding the Bug
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Debugging Waveforms: Finding the Bug">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#diagram-debug-workflow-visualization" class="md-nav__link">
    <span class="md-ellipsis">
      Diagram: Debug Workflow Visualization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synthesis-from-code-to-hardware" class="md-nav__link">
    <span class="md-ellipsis">
      Synthesis: From Code to Hardware
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#synthesizable-code-what-can-become-hardware" class="md-nav__link">
    <span class="md-ellipsis">
      Synthesizable Code: What Can Become Hardware
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#non-synthesizable-code-simulation-only" class="md-nav__link">
    <span class="md-ellipsis">
      Non-Synthesizable Code: Simulation Only
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Non-Synthesizable Code: Simulation Only">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#diagram-synthesizable-vs-non-synthesizable" class="md-nav__link">
    <span class="md-ellipsis">
      Diagram: Synthesizable vs Non-Synthesizable
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bringing-it-all-together-a-complete-verification-example" class="md-nav__link">
    <span class="md-ellipsis">
      Bringing It All Together: A Complete Verification Example
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary-and-key-takeaways" class="md-nav__link">
    <span class="md-ellipsis">
      Summary and Key Takeaways
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#practice-problems" class="md-nav__link">
    <span class="md-ellipsis">
      Practice Problems
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="testbenches-and-simulation">Testbenches and Simulation</h1>
<h2 id="summary">Summary</h2>
<p>This chapter covers the verification side of digital design, teaching students to validate their Verilog designs through simulation before hardware implementation. Students will learn to create testbenches, generate stimulus including clock signals and test vectors, build self-checking testbenches for automated verification, run simulations, and interpret results using waveform viewers for debugging. The chapter also covers the synthesis process, distinguishing between synthesizable and non-synthesizable code constructs, preparing students for FPGA implementation.</p>
<h2 id="concepts-covered">Concepts Covered</h2>
<p>This chapter covers the following 12 concepts from the learning graph:</p>
<ol>
<li>Testbench</li>
<li>Stimulus Generation</li>
<li>Clock Generation</li>
<li>Test Vector</li>
<li>Self-Checking Testbench</li>
<li>Simulation</li>
<li>Simulation Time</li>
<li>Waveform Viewer</li>
<li>Debugging Waveforms</li>
<li>Synthesis</li>
<li>Synthesizable Code</li>
<li>Non-Synthesizable Code</li>
</ol>
<h2 id="prerequisites">Prerequisites</h2>
<p>This chapter builds on concepts from:</p>
<ul>
<li><a href="../12-verilog-hdl-fundamentals/">Chapter 12: Verilog HDL Fundamentals</a></li>
<li><a href="../13-verilog-modeling/">Chapter 13: Verilog Behavioral and Structural Modeling</a></li>
</ul>
<hr />
<h2 id="introduction-trust-but-verify">Introduction: Trust, But Verify</h2>
<p>Here's a sobering thought: even the world's best digital designers make mistakes. The difference between professionals and amateurs isn't that professionals never introduce bugs—it's that they <em>find</em> those bugs before the silicon is cast in stone (or rather, cast in billions of tiny transistors).</p>
<p>In software, a bug means a patch, an update, a "please restart your application." In hardware, a bug discovered after manufacturing can mean millions of dollars in recalls, months of delays, or a very expensive doorstop. That's why verification—proving that your design actually does what you intended—consumes <em>more than half</em> of the engineering effort in professional chip design.</p>
<p>Welcome to the world of testbenches and simulation, where paranoia is a virtue!</p>
<p>Think of simulation as a dress rehearsal for your hardware. The design hasn't been built yet—it exists only as Verilog code—but the simulator pretends to execute it, cycle by cycle, checking whether it behaves correctly. If something goes wrong, you fix it in code rather than explaining to management why the chip needs a "metal spin."</p>
<p>This chapter teaches you to become your own worst critic. You'll learn to:</p>
<ul>
<li>Create testbenches that exercise every corner of your design</li>
<li>Generate realistic stimulus patterns automatically</li>
<li>Build self-checking systems that catch bugs without human intervention</li>
<li>Read and debug waveform displays like a pro</li>
<li>Understand what can be synthesized into hardware and what can't</li>
</ul>
<p>By the end, you'll have the skills to say with confidence: "Yes, I tested that. Thoroughly."</p>
<p>Let's make sure your designs work <em>before</em> they become hardware.</p>
<h2 id="what-is-a-testbench">What Is a Testbench?</h2>
<p>A <strong>Testbench</strong> is a Verilog module that provides stimulus to your design-under-test (DUT) and observes its outputs. Unlike synthesizable design modules, testbenches exist purely for verification—they're the scaffolding that lets you exercise and examine your circuit before it becomes real hardware.</p>
<p>Think of a testbench like a test fixture for electronics. If you've ever used a breadboard to test an IC by connecting it to switches, buttons, and LEDs, you've essentially built a physical testbench. A Verilog testbench is the same concept, but in simulation—you provide inputs, watch outputs, and decide if the behavior is correct.</p>
<p>Here's a minimal testbench structure:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">module</span><span class="w"> </span><span class="n">my_design_tb</span><span class="p">;</span><span class="w">  </span><span class="c1">// No ports! Testbenches are self-contained</span>

<span class="w">    </span><span class="c1">// Declare signals to connect to DUT</span>
<span class="w">    </span><span class="kt">reg</span><span class="w">  </span><span class="n">clk</span><span class="p">;</span>
<span class="w">    </span><span class="kt">reg</span><span class="w">  </span><span class="n">reset</span><span class="p">;</span>
<span class="w">    </span><span class="kt">reg</span><span class="w">  </span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">data_in</span><span class="p">;</span>
<span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">data_out</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Instantiate the Device Under Test</span>
<span class="w">    </span><span class="n">my_design</span><span class="w"> </span><span class="n">dut</span><span class="p">(</span>
<span class="w">        </span><span class="p">.</span><span class="n">clk</span><span class="p">(</span><span class="n">clk</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">reset</span><span class="p">(</span><span class="n">reset</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">data_in</span><span class="p">(</span><span class="n">data_in</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">data_out</span><span class="p">(</span><span class="n">data_out</span><span class="p">)</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Generate clock</span>
<span class="w">    </span><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">        </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">        </span><span class="k">forever</span><span class="w"> </span><span class="p">#</span><span class="mh">5</span><span class="w"> </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">clk</span><span class="p">;</span><span class="w">  </span><span class="c1">// 100 MHz clock</span>
<span class="w">    </span><span class="k">end</span>

<span class="w">    </span><span class="c1">// Apply stimulus</span>
<span class="w">    </span><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">        </span><span class="c1">// Initialize inputs</span>
<span class="w">        </span><span class="n">reset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span>
<span class="w">        </span><span class="n">data_in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">8&#39;h00</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// Release reset after some time</span>
<span class="w">        </span><span class="p">#</span><span class="mh">20</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// Apply test patterns</span>
<span class="w">        </span><span class="p">#</span><span class="mh">10</span><span class="w"> </span><span class="n">data_in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">8&#39;hAB</span><span class="p">;</span>
<span class="w">        </span><span class="p">#</span><span class="mh">10</span><span class="w"> </span><span class="n">data_in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">8&#39;hCD</span><span class="p">;</span>
<span class="w">        </span><span class="p">#</span><span class="mh">10</span><span class="w"> </span><span class="n">data_in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">8&#39;hEF</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// End simulation</span>
<span class="w">        </span><span class="p">#</span><span class="mh">100</span><span class="w"> </span><span class="nb">$finish</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span>

<span class="k">endmodule</span>
</code></pre></div></td></tr></table></div>
<p>Key characteristics of testbenches:</p>
<ul>
<li><strong>No port list</strong>: Testbenches are top-level modules with no external connections</li>
<li><strong>reg for inputs</strong>: Signals driving the DUT are declared as <code>reg</code> (because we assign them procedurally)</li>
<li><strong>wire for outputs</strong>: Signals coming from the DUT are <code>wire</code> (because the DUT drives them)</li>
<li><strong>Not synthesizable</strong>: Testbenches use constructs that only work in simulation</li>
</ul>
<div class="admonition note">
<p class="admonition-title">The DUT Convention</p>
<p>By convention, we name the instantiated design <code>dut</code> (Device Under Test) or <code>uut</code> (Unit Under Test). This makes it clear which module is being tested versus which is doing the testing.</p>
</div>
<h4 id="diagram-testbench-architecture">Diagram: Testbench Architecture</h4>
<iframe src="../../sims/testbench-architecture/main.html" width="100%" height="500px" scrolling="no"></iframe>

<details>
<summary>Testbench Architecture Visualization</summary>
<p>Type: infographic</p>
<p>Bloom Level: Understand (L2)
Bloom Verb: Explain</p>
<p>Learning Objective: Students will be able to explain the relationship between a testbench and the device under test, understanding how stimulus flows into the DUT and responses flow out to verification logic.</p>
<p>Instructional Rationale: Interactive block diagram showing testbench components (stimulus generator, DUT, response checker) with data flow arrows makes the testbench structure tangible.</p>
<p>Canvas Layout:</p>
<ul>
<li>Center: DUT block with ports</li>
<li>Left: Stimulus generator block</li>
<li>Right: Response checker block</li>
<li>Bottom: Shared clock generator</li>
<li>Arrows showing signal flow</li>
</ul>
<p>Interactive Elements:</p>
<ul>
<li>Hover over components to see descriptions</li>
<li>Click to highlight signal paths</li>
<li>Show/hide internal details</li>
<li>Animation mode showing stimulus flow</li>
<li>Toggle between simple and self-checking testbench views</li>
</ul>
<p>Data Visibility:</p>
<ul>
<li>Component roles and responsibilities</li>
<li>Signal connections between blocks</li>
<li>Input/output relationships</li>
<li>Verification flow</li>
</ul>
<p>Visual Style:</p>
<ul>
<li>Block diagram with clear boundaries</li>
<li>Directional arrows for signal flow</li>
<li>Color coding (blue=stimulus, green=DUT, red=checker)</li>
<li>Clean, professional appearance</li>
<li>Responsive to window resize</li>
</ul>
<p>Implementation: p5.js with interactive block diagram</p>
</details>
<p>The typical testbench flow is:</p>
<ol>
<li><strong>Initialize</strong>: Set all inputs to known values</li>
<li><strong>Reset</strong>: Assert reset to put DUT in known state</li>
<li><strong>Stimulate</strong>: Apply input patterns over time</li>
<li><strong>Observe</strong>: Watch outputs (manually or automatically)</li>
<li><strong>Complete</strong>: End simulation when testing is done</li>
</ol>
<h2 id="stimulus-generation-feeding-the-beast">Stimulus Generation: Feeding the Beast</h2>
<p><strong>Stimulus Generation</strong> is the art of creating input patterns that thoroughly exercise your design. Good stimulus covers normal operation, edge cases, error conditions, and corner cases—basically, anything that might reveal a bug.</p>
<p>There are several approaches to generating stimulus:</p>
<p><strong>Direct assignment</strong> (simplest):
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">8&#39;h00</span><span class="p">;</span>
<span class="w">    </span><span class="p">#</span><span class="mh">10</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">8&#39;h55</span><span class="p">;</span>
<span class="w">    </span><span class="p">#</span><span class="mh">10</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">8&#39;hAA</span><span class="p">;</span>
<span class="w">    </span><span class="p">#</span><span class="mh">10</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">8&#39;hFF</span><span class="p">;</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Loops</strong> (for repetitive patterns):
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mh">256</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">        </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">        </span><span class="p">#</span><span class="mh">10</span><span class="p">;</span><span class="w">  </span><span class="c1">// Wait between values</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Random values</strong> (for broader coverage):
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="k">repeat</span><span class="w"> </span><span class="p">(</span><span class="mh">100</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">        </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">$random</span><span class="p">;</span><span class="w">  </span><span class="c1">// Random 32-bit value</span>
<span class="w">        </span><span class="p">#</span><span class="mh">10</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>File-based</strong> (for complex or recorded patterns):
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="nb">$readmemh</span><span class="p">(</span><span class="s">&quot;test_vectors.hex&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">test_data</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">TEST_COUNT</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">        </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test_data</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">        </span><span class="p">#</span><span class="mh">10</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div></p>
<p>Good stimulus generation follows these principles:</p>
<table>
<thead>
<tr>
<th>Principle</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>Start known</td>
<td>Begin from a defined state</td>
<td>Assert reset first</td>
</tr>
<tr>
<td>Cover boundaries</td>
<td>Test at value limits</td>
<td>0, 1, max-1, max</td>
</tr>
<tr>
<td>Exercise transitions</td>
<td>Test state changes</td>
<td>All FSM transitions</td>
</tr>
<tr>
<td>Include invalid</td>
<td>Test error handling</td>
<td>Out-of-range inputs</td>
</tr>
<tr>
<td>Be reproducible</td>
<td>Same tests, same results</td>
<td>Use seed for random</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">The 80/20 Rule of Testing</p>
<p>80% of bugs are found by testing boundary conditions and transitions. Don't just test "happy path" scenarios—test what happens when inputs are 0, maximum value, or change rapidly.</p>
</div>
<p>Here's a more comprehensive stimulus example for an 8-bit counter:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="c1">// Initialize</span>
<span class="w">    </span><span class="n">reset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">load</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">load_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">8&#39;h00</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Test 1: Reset behavior</span>
<span class="w">    </span><span class="p">#</span><span class="mh">20</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Test 2: Enable counting</span>
<span class="w">    </span><span class="p">#</span><span class="mh">10</span><span class="w"> </span><span class="n">enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">#</span><span class="mh">100</span><span class="p">;</span><span class="w">  </span><span class="c1">// Let it count for a while</span>

<span class="w">    </span><span class="c1">// Test 3: Disable should hold value</span>
<span class="w">    </span><span class="n">enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">#</span><span class="mh">50</span><span class="p">;</span><span class="w">  </span><span class="c1">// Verify count doesn&#39;t change</span>

<span class="w">    </span><span class="c1">// Test 4: Load functionality</span>
<span class="w">    </span><span class="n">load</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">load_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">8&#39;hFE</span><span class="p">;</span><span class="w">  </span><span class="c1">// Near max</span>
<span class="w">    </span><span class="p">#</span><span class="mh">10</span><span class="w"> </span><span class="n">load</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Test 5: Rollover at max</span>
<span class="w">    </span><span class="n">enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">#</span><span class="mh">50</span><span class="p">;</span><span class="w">  </span><span class="c1">// Should roll over from FF to 00</span>

<span class="w">    </span><span class="c1">// Test 6: Reset during operation</span>
<span class="w">    </span><span class="p">#</span><span class="mh">10</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">#</span><span class="mh">10</span><span class="w"> </span><span class="n">reset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>

<span class="w">    </span><span class="p">#</span><span class="mh">50</span><span class="w"> </span><span class="nb">$finish</span><span class="p">;</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div>
<h4 id="diagram-stimulus-pattern-generator">Diagram: Stimulus Pattern Generator</h4>
<iframe src="../../sims/stimulus-generator/main.html" width="100%" height="500px" scrolling="no"></iframe>

<details>
<summary>Stimulus Pattern Generator</summary>
<p>Type: microsim</p>
<p>Bloom Level: Apply (L3)
Bloom Verb: Demonstrate</p>
<p>Learning Objective: Students will be able to demonstrate how different stimulus generation techniques produce different input patterns by comparing direct assignment, loops, and random generation.</p>
<p>Instructional Rationale: Interactive comparison of stimulus methods with visible pattern output shows the trade-offs between simplicity, coverage, and reproducibility.</p>
<p>Canvas Layout:</p>
<ul>
<li>Left: Stimulus method selector (tabs)</li>
<li>Center: Generated pattern visualization</li>
<li>Right: Pattern statistics (coverage, unique values)</li>
<li>Bottom: Verilog code for selected method</li>
</ul>
<p>Interactive Elements:</p>
<ul>
<li>Tab selection for method type</li>
<li>Play/pause pattern generation</li>
<li>Speed control for animation</li>
<li>Reset to regenerate patterns</li>
<li>Coverage histogram display</li>
<li>Export pattern capability</li>
</ul>
<p>Data Visibility:</p>
<ul>
<li>Generated values over time</li>
<li>Coverage percentage</li>
<li>Repetition detection</li>
<li>Pattern characteristics</li>
<li>Corresponding Verilog code</li>
</ul>
<p>Visual Style:</p>
<ul>
<li>Value display as scrolling list</li>
<li>Histogram of value distribution</li>
<li>Color gradient for value magnitude</li>
<li>Code panel with syntax highlighting</li>
<li>Responsive layout</li>
</ul>
<p>Implementation: p5.js with multiple generation engines</p>
</details>
<h2 id="clock-generation-the-heartbeat">Clock Generation: The Heartbeat</h2>
<p><strong>Clock Generation</strong> creates the clock signal that synchronizes all sequential logic in your design. Since clocks don't exist in the real world until you create them, your testbench must generate them.</p>
<p>The classic clock generation pattern:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">forever</span><span class="w"> </span><span class="p">#</span><span class="mh">5</span><span class="w"> </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">clk</span><span class="p">;</span><span class="w">  </span><span class="c1">// Toggle every 5 time units</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>This creates a clock with a period of 10 time units (5 high + 5 low).</p>
<p>For more control over clock characteristics:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">parameter</span><span class="w"> </span><span class="n">CLK_PERIOD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">10</span><span class="p">;</span><span class="w">  </span><span class="c1">// 10ns period = 100 MHz</span>

<span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">forever</span><span class="w"> </span><span class="p">#(</span><span class="n">CLK_PERIOD</span><span class="o">/</span><span class="mh">2</span><span class="p">)</span><span class="w"> </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">clk</span><span class="p">;</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>You can also create clocks with non-50% duty cycles:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// 60% duty cycle clock</span>
<span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">forever</span><span class="w"> </span><span class="k">begin</span>
<span class="w">        </span><span class="p">#</span><span class="mh">6</span><span class="w"> </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span><span class="w">  </span><span class="c1">// High for 6 time units</span>
<span class="w">        </span><span class="p">#</span><span class="mh">4</span><span class="w"> </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w">  </span><span class="c1">// Low for 4 time units</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>Multiple clocks at different frequencies:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Fast clock: 100 MHz</span>
<span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="n">clk_fast</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">forever</span><span class="w"> </span><span class="p">#</span><span class="mh">5</span><span class="w"> </span><span class="n">clk_fast</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">clk_fast</span><span class="p">;</span>
<span class="k">end</span>

<span class="c1">// Slow clock: 10 MHz</span>
<span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="n">clk_slow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">forever</span><span class="w"> </span><span class="p">#</span><span class="mh">50</span><span class="w"> </span><span class="n">clk_slow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">clk_slow</span><span class="p">;</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div>
<div class="admonition warning">
<p class="admonition-title">Clock and Data Alignment</p>
<p>Be careful about the timing relationship between your clock and data changes. Changing data exactly at the clock edge can cause race conditions in simulation. Best practice: change data slightly after the clock edge or use non-blocking assignments.</p>
</div>
<p>A robust pattern that avoids race conditions:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">forever</span><span class="w"> </span><span class="p">#</span><span class="mh">5</span><span class="w"> </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">clk</span><span class="p">;</span>
<span class="k">end</span>

<span class="c1">// Change data after clock edge, not exactly at it</span>
<span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="n">reset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">@(</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">);</span><span class="w">  </span><span class="c1">// Wait for clock edge</span>
<span class="w">    </span><span class="p">#</span><span class="mh">1</span><span class="p">;</span><span class="w">              </span><span class="c1">// Small delay after edge</span>
<span class="w">    </span><span class="n">reset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w">       </span><span class="c1">// Now change data</span>

<span class="w">    </span><span class="p">@(</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">);</span>
<span class="w">    </span><span class="p">#</span><span class="mh">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">8&#39;hAB</span><span class="p">;</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div>
<h4 id="diagram-clock-waveform-generator">Diagram: Clock Waveform Generator</h4>
<iframe src="../../sims/clock-generator/main.html" width="100%" height="450px" scrolling="no"></iframe>

<details>
<summary>Clock Waveform Generator</summary>
<p>Type: microsim</p>
<p>Bloom Level: Apply (L3)
Bloom Verb: Use</p>
<p>Learning Objective: Students will be able to use different clock generation parameters to create clocks with specific frequencies, duty cycles, and phases.</p>
<p>Instructional Rationale: Interactive clock generator with adjustable parameters and real-time waveform display makes clock timing relationships concrete.</p>
<p>Canvas Layout:</p>
<ul>
<li>Top: Waveform display showing generated clock</li>
<li>Middle: Parameter controls (period, duty cycle, phase)</li>
<li>Bottom: Generated Verilog code</li>
</ul>
<p>Interactive Elements:</p>
<ul>
<li>Sliders for period, duty cycle, phase</li>
<li>Frequency calculator (period ↔ frequency)</li>
<li>Multiple clock mode (add second clock)</li>
<li>Show timing measurements</li>
<li>Copy Verilog code button</li>
</ul>
<p>Data Visibility:</p>
<ul>
<li>Clock waveform with timing markers</li>
<li>Calculated frequency</li>
<li>Duty cycle percentage</li>
<li>Phase relationship (if two clocks)</li>
<li>Generated Verilog code</li>
</ul>
<p>Visual Style:</p>
<ul>
<li>Clean waveform display</li>
<li>Measurement annotations</li>
<li>Real-time update on parameter change</li>
<li>Professional timing diagram appearance</li>
<li>Responsive canvas</li>
</ul>
<p>Implementation: p5.js with parametric clock generation</p>
</details>
<h2 id="test-vectors-organized-test-data">Test Vectors: Organized Test Data</h2>
<p>A <strong>Test Vector</strong> is a specific set of input values along with the expected output values for those inputs. Test vectors organize your test cases into a structured format that can be applied systematically and verified automatically.</p>
<p>Simple test vectors in Verilog:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Test vectors for a 2-bit adder: {a, b, expected_sum}</span>
<span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">5</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">test_vectors</span><span class="w"> </span><span class="p">[</span><span class="mh">0</span><span class="o">:</span><span class="mh">8</span><span class="p">];</span>

<span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="n">test_vectors</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b00</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b00</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b00</span><span class="p">};</span><span class="w">  </span><span class="c1">// 0 + 0 = 0</span>
<span class="w">    </span><span class="n">test_vectors</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b00</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b01</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b01</span><span class="p">};</span><span class="w">  </span><span class="c1">// 0 + 1 = 1</span>
<span class="w">    </span><span class="n">test_vectors</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b01</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b00</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b01</span><span class="p">};</span><span class="w">  </span><span class="c1">// 1 + 0 = 1</span>
<span class="w">    </span><span class="n">test_vectors</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b01</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b01</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b10</span><span class="p">};</span><span class="w">  </span><span class="c1">// 1 + 1 = 2</span>
<span class="w">    </span><span class="n">test_vectors</span><span class="p">[</span><span class="mh">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b10</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b01</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b11</span><span class="p">};</span><span class="w">  </span><span class="c1">// 2 + 1 = 3</span>
<span class="w">    </span><span class="n">test_vectors</span><span class="p">[</span><span class="mh">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b11</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b00</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b11</span><span class="p">};</span><span class="w">  </span><span class="c1">// 3 + 0 = 3</span>
<span class="w">    </span><span class="n">test_vectors</span><span class="p">[</span><span class="mh">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b11</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b01</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b00</span><span class="p">};</span><span class="w">  </span><span class="c1">// 3 + 1 = 4 (overflow!)</span>
<span class="w">    </span><span class="n">test_vectors</span><span class="p">[</span><span class="mh">7</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b11</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b11</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b10</span><span class="p">};</span><span class="w">  </span><span class="c1">// 3 + 3 = 6 (overflow!)</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>Loading test vectors from a file is cleaner for large test suites:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// test_vectors.hex contains:</span>
<span class="c1">// 00_00_00</span>
<span class="c1">// 00_01_01</span>
<span class="c1">// 01_01_02</span>
<span class="c1">// ...</span>

<span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">5</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">test_vectors</span><span class="w"> </span><span class="p">[</span><span class="mh">0</span><span class="o">:</span><span class="mh">255</span><span class="p">];</span>
<span class="k">initial</span><span class="w"> </span><span class="nb">$readmemh</span><span class="p">(</span><span class="s">&quot;test_vectors.hex&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">test_vectors</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>Applying test vectors systematically:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">integer</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">a_test</span><span class="p">,</span><span class="w"> </span><span class="n">b_test</span><span class="p">,</span><span class="w"> </span><span class="n">expected_sum</span><span class="p">;</span>

<span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mh">8</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">        </span><span class="c1">// Extract test vector components</span>
<span class="w">        </span><span class="n">a_test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test_vectors</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mh">5</span><span class="o">:</span><span class="mh">4</span><span class="p">];</span>
<span class="w">        </span><span class="n">b_test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test_vectors</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mh">3</span><span class="o">:</span><span class="mh">2</span><span class="p">];</span>
<span class="w">        </span><span class="n">expected_sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test_vectors</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">];</span>

<span class="w">        </span><span class="c1">// Apply inputs</span>
<span class="w">        </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a_test</span><span class="p">;</span>
<span class="w">        </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b_test</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// Wait for combinational logic to settle</span>
<span class="w">        </span><span class="p">#</span><span class="mh">5</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// Check result</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sum</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="n">expected_sum</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;ERROR: a=%d, b=%d, expected=%d, got=%d&quot;</span><span class="p">,</span>
<span class="w">                     </span><span class="n">a_test</span><span class="p">,</span><span class="w"> </span><span class="n">b_test</span><span class="p">,</span><span class="w"> </span><span class="n">expected_sum</span><span class="p">,</span><span class="w"> </span><span class="n">sum</span><span class="p">);</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>

<span class="w">    </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;Test complete!&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nb">$finish</span><span class="p">;</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>Benefits of test vectors:</p>
<ul>
<li><strong>Organized</strong>: All test cases in one place</li>
<li><strong>Reusable</strong>: Can share vectors between testbenches</li>
<li><strong>Maintainable</strong>: Easy to add new test cases</li>
<li><strong>Portable</strong>: Can be generated by external tools</li>
<li><strong>Documented</strong>: The vector file itself documents expected behavior</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Golden Reference Model</p>
<p>A common practice is to generate test vectors using a software reference model (in Python, C, etc.) that computes the expected outputs. This "golden model" can produce thousands of test cases automatically, which you then verify against your Verilog implementation.</p>
</div>
<h2 id="self-checking-testbenches-automation-is-your-friend">Self-Checking Testbenches: Automation Is Your Friend</h2>
<p>A <strong>Self-Checking Testbench</strong> automatically verifies that the DUT produces correct outputs, reporting errors without human intervention. This is the difference between "I looked at the waveforms and they seemed right" and "I verified 10,000 test cases and they all passed."</p>
<p>The key insight: instead of manually examining waveforms, embed the expected behavior in the testbench itself.</p>
<p>Basic self-checking pattern:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Check after each test</span>
<span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="c1">// Apply test</span>
<span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">8&#39;h05</span><span class="p">;</span>
<span class="w">    </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">8&#39;h03</span><span class="p">;</span>
<span class="w">    </span><span class="p">#</span><span class="mh">10</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Automatic check</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sum</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="mh">8&#39;h08</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">        </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;FAIL: 5 + 3 should be 8, got %d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sum</span><span class="p">);</span>
<span class="w">        </span><span class="n">error_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error_count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">begin</span>
<span class="w">        </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;PASS: 5 + 3 = 8&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>More sophisticated self-checking with a reference model:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Reference model function</span>
<span class="k">function</span><span class="w"> </span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">expected_alu_result</span><span class="p">;</span>
<span class="w">    </span><span class="k">input</span><span class="w"> </span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">    </span><span class="k">input</span><span class="w"> </span><span class="p">[</span><span class="mh">2</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">op</span><span class="p">;</span>
<span class="w">    </span><span class="k">begin</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="n">op</span><span class="p">)</span>
<span class="w">            </span><span class="mh">3</span><span class="mb">&#39;b000</span><span class="o">:</span><span class="w"> </span><span class="n">expected_alu_result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">            </span><span class="mh">3</span><span class="mb">&#39;b001</span><span class="o">:</span><span class="w"> </span><span class="n">expected_alu_result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">            </span><span class="mh">3</span><span class="mb">&#39;b010</span><span class="o">:</span><span class="w"> </span><span class="n">expected_alu_result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">            </span><span class="mh">3</span><span class="mb">&#39;b011</span><span class="o">:</span><span class="w"> </span><span class="n">expected_alu_result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">            </span><span class="mh">3</span><span class="mb">&#39;b100</span><span class="o">:</span><span class="w"> </span><span class="n">expected_alu_result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">            </span><span class="k">default</span><span class="o">:</span><span class="w"> </span><span class="n">expected_alu_result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">8&#39;h00</span><span class="p">;</span>
<span class="w">        </span><span class="k">endcase</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">endfunction</span>

<span class="c1">// Self-checking test loop</span>
<span class="k">integer</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">errors</span><span class="p">;</span>
<span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="n">errors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mh">1000</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">        </span><span class="c1">// Random test inputs</span>
<span class="w">        </span><span class="n">a_in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">$random</span><span class="p">;</span>
<span class="w">        </span><span class="n">b_in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">$random</span><span class="p">;</span>
<span class="w">        </span><span class="n">op_in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">$random</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mh">5</span><span class="p">;</span>
<span class="w">        </span><span class="p">#</span><span class="mh">10</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// Compare against reference</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="n">expected_alu_result</span><span class="p">(</span><span class="n">a_in</span><span class="p">,</span><span class="w"> </span><span class="n">b_in</span><span class="p">,</span><span class="w"> </span><span class="n">op_in</span><span class="p">))</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;ERROR at time %0t: a=%h, b=%h, op=%d&quot;</span><span class="p">,</span>
<span class="w">                     </span><span class="nb">$time</span><span class="p">,</span><span class="w"> </span><span class="n">a_in</span><span class="p">,</span><span class="w"> </span><span class="n">b_in</span><span class="p">,</span><span class="w"> </span><span class="n">op_in</span><span class="p">);</span>
<span class="w">            </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;  Expected: %h, Got: %h&quot;</span><span class="p">,</span>
<span class="w">                     </span><span class="n">expected_alu_result</span><span class="p">(</span><span class="n">a_in</span><span class="p">,</span><span class="w"> </span><span class="n">b_in</span><span class="p">,</span><span class="w"> </span><span class="n">op_in</span><span class="p">),</span><span class="w"> </span><span class="n">result</span><span class="p">);</span>
<span class="w">            </span><span class="n">errors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">errors</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>

<span class="w">    </span><span class="c1">// Final report</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">errors</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0</span><span class="p">)</span>
<span class="w">        </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;SUCCESS: All 1000 tests passed!&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;FAILED: %d errors detected&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">errors</span><span class="p">);</span>

<span class="w">    </span><span class="nb">$finish</span><span class="p">;</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div>
<h4 id="diagram-self-checking-testbench-flow">Diagram: Self-Checking Testbench Flow</h4>
<iframe src="../../sims/self-checking-tb/main.html" width="100%" height="550px" scrolling="no"></iframe>

<details>
<summary>Self-Checking Testbench Flow</summary>
<p>Type: microsim</p>
<p>Bloom Level: Analyze (L4)
Bloom Verb: Compare</p>
<p>Learning Objective: Students will be able to compare DUT outputs against expected values automatically, understanding how self-checking testbenches detect and report errors.</p>
<p>Instructional Rationale: Animated testbench execution showing stimulus application, output capture, comparison, and pass/fail reporting demonstrates the complete verification loop.</p>
<p>Canvas Layout:</p>
<ul>
<li>Top: Stimulus generator block</li>
<li>Center: DUT with inputs and outputs</li>
<li>Right: Reference model computing expected values</li>
<li>Bottom: Comparator with pass/fail indicators</li>
<li>Side: Error log display</li>
</ul>
<p>Interactive Elements:</p>
<ul>
<li>Step through test vectors one at a time</li>
<li>Run all tests automatically</li>
<li>Inject error into DUT (to see failure detection)</li>
<li>View error log</li>
<li>Statistics display (pass/fail counts)</li>
<li>Reset and rerun</li>
</ul>
<p>Data Visibility:</p>
<ul>
<li>Current test vector</li>
<li>Applied inputs</li>
<li>DUT outputs</li>
<li>Expected outputs</li>
<li>Comparison result (pass/fail)</li>
<li>Running totals</li>
</ul>
<p>Visual Style:</p>
<ul>
<li>Flow diagram with animated data movement</li>
<li>Green checks for pass, red X for fail</li>
<li>Progress bar for test completion</li>
<li>Error highlighting</li>
<li>Professional verification theme</li>
</ul>
<p>Implementation: p5.js with comparison engine and logging</p>
</details>
<p>Elements of a professional self-checking testbench:</p>
<table>
<thead>
<tr>
<th>Element</th>
<th>Purpose</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>Error counter</td>
<td>Track total failures</td>
<td><code>integer errors = 0;</code></td>
</tr>
<tr>
<td>Test counter</td>
<td>Track coverage</td>
<td><code>integer tests = 0;</code></td>
</tr>
<tr>
<td>Timestamps</td>
<td>Locate failures</td>
<td><code>$display("Time %0t:", $time);</code></td>
</tr>
<tr>
<td>Verbose mode</td>
<td>Detailed output for debugging</td>
<td><code>if (VERBOSE) $display(...);</code></td>
</tr>
<tr>
<td>Summary report</td>
<td>Overall pass/fail</td>
<td>Print at <code>$finish</code></td>
</tr>
</tbody>
</table>
<div class="admonition success">
<p class="admonition-title">The Professional Standard</p>
<p>In industry, designs are often verified with millions of test cycles. No human can check that many waveforms manually. Self-checking testbenches are not optional—they're essential for any serious verification effort.</p>
</div>
<h2 id="simulation-running-your-design-without-hardware">Simulation: Running Your Design (Without Hardware)</h2>
<p><strong>Simulation</strong> is the process of executing your Verilog code in a software environment that mimics hardware behavior. The simulator processes your design and testbench, computing signal values at each moment in simulated time.</p>
<p>The simulation process:</p>
<ol>
<li><strong>Compile</strong>: Parse Verilog files and build internal representation</li>
<li><strong>Elaborate</strong>: Instantiate all modules and resolve hierarchies</li>
<li><strong>Initialize</strong>: Set all signals to their starting values</li>
<li><strong>Execute</strong>: Process events in time order until simulation ends</li>
<li><strong>Report</strong>: Generate output files and waveform data</li>
</ol>
<p>Common Verilog simulators:</p>
<table>
<thead>
<tr>
<th>Simulator</th>
<th>Vendor</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>ModelSim/Questa</td>
<td>Siemens (Mentor)</td>
<td>Industry standard, powerful</td>
</tr>
<tr>
<td>VCS</td>
<td>Synopsys</td>
<td>High performance</td>
</tr>
<tr>
<td>Xcelium</td>
<td>Cadence</td>
<td>Advanced features</td>
</tr>
<tr>
<td>Icarus Verilog</td>
<td>Open source</td>
<td>Free, good for learning</td>
</tr>
<tr>
<td>Verilator</td>
<td>Open source</td>
<td>Very fast, converts to C++</td>
</tr>
<tr>
<td>Vivado Simulator</td>
<td>AMD (Xilinx)</td>
<td>Built into Vivado</td>
</tr>
</tbody>
</table>
<p>Running a simulation typically looks like:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1"># Icarus Verilog example</span>
iverilog<span class="w"> </span>-o<span class="w"> </span>sim.out<span class="w"> </span>design.v<span class="w"> </span>testbench.v
vvp<span class="w"> </span>sim.out

<span class="c1"># ModelSim example</span>
vlog<span class="w"> </span>design.v<span class="w"> </span>testbench.v
vsim<span class="w"> </span>work.testbench
run<span class="w"> </span>-all
</code></pre></div></td></tr></table></div>
<p>The simulator executes concurrent processes (always blocks, continuous assignments) by processing <em>events</em> at each moment in time. When a signal changes, all processes sensitive to that signal are evaluated, potentially creating new events.</p>
<div class="admonition warning">
<p class="admonition-title">Simulation Is Not Reality</p>
<p>Simulation is an <em>approximation</em> of hardware behavior. Real hardware has physical delays, noise, temperature effects, and manufacturing variations that simulators ignore. A design that simulates perfectly might still fail in hardware due to timing issues. That's why we also have <em>timing simulation</em> with real delay values—but that comes later in the design flow.</p>
</div>
<p>Key simulation concepts:</p>
<ul>
<li><strong>Event</strong>: A signal value change at a specific time</li>
<li><strong>Delta cycle</strong>: Time advances in infinitesimal steps to handle concurrent updates</li>
<li><strong>Blocking</strong>: Some constructs pause until a condition is met</li>
<li><strong>Timescale</strong>: Defines the unit of time (e.g., 1ns/1ps)</li>
</ul>
<p>Setting the timescale:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="no">`timescale</span><span class="w"> </span><span class="mh">1</span><span class="n">ns</span><span class="o">/</span><span class="mh">1</span><span class="n">ps</span><span class="w">  </span><span class="c1">// Time unit is 1ns, precision is 1ps</span>

<span class="k">module</span><span class="w"> </span><span class="n">testbench</span><span class="p">;</span>
<span class="w">    </span><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">        </span><span class="p">#</span><span class="mf">10.5</span><span class="p">;</span><span class="w">  </span><span class="c1">// Wait 10.5 nanoseconds</span>
<span class="w">        </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;Time is %0t&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">$time</span><span class="p">);</span><span class="w">  </span><span class="c1">// Prints &quot;Time is 10500&quot;</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">endmodule</span>
</code></pre></div></td></tr></table></div>
<h2 id="simulation-time-understanding-the-delay">Simulation Time: Understanding the <code>#</code> Delay</h2>
<p><strong>Simulation Time</strong> is the virtual clock that advances during simulation. It's controlled by delay statements (<code>#</code>) and wait statements (<code>@</code>), and it has no relationship to how long the simulation takes to run on your computer.</p>
<p>The <code>#</code> delay operator suspends execution for a specified number of time units:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w">     </span><span class="c1">// Time 0</span>
<span class="w">    </span><span class="p">#</span><span class="mh">10</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// Time 10</span>
<span class="w">    </span><span class="p">#</span><span class="mh">5</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w">  </span><span class="c1">// Time 15</span>
<span class="w">    </span><span class="p">#</span><span class="mh">20</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span><span class="w"> </span><span class="c1">// Time 35</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>Multiple processes advance in parallel:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Process 1</span>
<span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">#</span><span class="mh">10</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">#</span><span class="mh">10</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="k">end</span>

<span class="c1">// Process 2 (runs simultaneously!)</span>
<span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">#</span><span class="mh">15</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">#</span><span class="mh">5</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>At each time step, the simulator:</p>
<ol>
<li>Executes all statements that are ready at this time</li>
<li>Processes any resulting signal changes</li>
<li>Advances time to the next scheduled event</li>
</ol>
<h4 id="diagram-simulation-time-visualization">Diagram: Simulation Time Visualization</h4>
<iframe src="../../sims/simulation-time/main.html" width="100%" height="500px" scrolling="no"></iframe>

<details>
<summary>Simulation Time Visualization</summary>
<p>Type: microsim</p>
<p>Bloom Level: Understand (L2)
Bloom Verb: Explain</p>
<p>Learning Objective: Students will be able to explain how simulation time advances through delay statements and concurrent process execution.</p>
<p>Instructional Rationale: Animated timeline showing multiple initial blocks advancing in parallel with delay annotations demonstrates the concurrent-yet-ordered nature of simulation.</p>
<p>Canvas Layout:</p>
<ul>
<li>Top: Timeline with time markers</li>
<li>Center: Multiple process tracks (like Gantt chart)</li>
<li>Bottom: Current simulation time display</li>
<li>Side: Event queue visualization</li>
</ul>
<p>Interactive Elements:</p>
<ul>
<li>Step forward in time</li>
<li>Continuous play mode with speed control</li>
<li>Pause at interesting moments</li>
<li>Highlight current executing process</li>
<li>Show event queue contents</li>
<li>Reset to time 0</li>
</ul>
<p>Data Visibility:</p>
<ul>
<li>Current simulation time</li>
<li>Each process's current statement</li>
<li>Delay values between events</li>
<li>Concurrent execution visualization</li>
<li>Event queue contents</li>
</ul>
<p>Visual Style:</p>
<ul>
<li>Timeline with tick marks</li>
<li>Process bars showing execution</li>
<li>Delay annotations as arrows</li>
<li>Current time as moving cursor</li>
<li>Color coding for different processes</li>
</ul>
<p>Implementation: p5.js with discrete event simulation</p>
</details>
<p>Important timing system tasks:</p>
<table>
<thead>
<tr>
<th>Task</th>
<th>Purpose</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>$time</code></td>
<td>Current simulation time</td>
<td><code>$display("Time: %0t", $time);</code></td>
</tr>
<tr>
<td><code>$realtime</code></td>
<td>Time as real number</td>
<td><code>$display("Time: %0f", $realtime);</code></td>
</tr>
<tr>
<td><code>$finish</code></td>
<td>End simulation</td>
<td><code>#1000 $finish;</code></td>
</tr>
<tr>
<td><code>$stop</code></td>
<td>Pause simulation</td>
<td><code>if (error) $stop;</code></td>
</tr>
</tbody>
</table>
<p>The wait statement (<code>@</code>) suspends until an event:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="p">@(</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">);</span><span class="w">    </span><span class="c1">// Wait for rising edge</span>
<span class="w">    </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">8&#39;hAB</span><span class="p">;</span>
<span class="w">    </span><span class="p">@(</span><span class="k">negedge</span><span class="w"> </span><span class="n">reset</span><span class="p">);</span><span class="w">  </span><span class="c1">// Wait for reset falling edge</span>
<span class="w">    </span><span class="p">@(</span><span class="n">done</span><span class="p">);</span><span class="w">           </span><span class="c1">// Wait for any change on &#39;done&#39;</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>Combining delay and events:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="n">reset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">#</span><span class="mh">20</span><span class="p">;</span><span class="w">                    </span><span class="c1">// Wait 20 time units</span>
<span class="w">    </span><span class="n">reset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">@(</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">);</span><span class="w">         </span><span class="c1">// Wait for clock edge</span>
<span class="w">    </span><span class="p">#</span><span class="mh">1</span><span class="p">;</span><span class="w">                     </span><span class="c1">// Small delay after edge</span>
<span class="w">    </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">8&#39;hFF</span><span class="p">;</span>
<span class="w">    </span><span class="k">repeat</span><span class="p">(</span><span class="mh">10</span><span class="p">)</span><span class="w"> </span><span class="p">@(</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">);</span><span class="w">  </span><span class="c1">// Wait for 10 clock cycles</span>
<span class="w">    </span><span class="nb">$finish</span><span class="p">;</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div>
<h2 id="waveform-viewer-seeing-is-believing">Waveform Viewer: Seeing Is Believing</h2>
<p>A <strong>Waveform Viewer</strong> displays signal values over time as graphical traces, allowing you to visualize how your design behaves during simulation. It's the oscilloscope of the simulation world.</p>
<p>Waveform viewers show:</p>
<ul>
<li><strong>Digital signals</strong>: Square waves transitioning between 0 and 1</li>
<li><strong>Multi-bit buses</strong>: Values as hex or decimal numbers</li>
<li><strong>Analog-style</strong>: Stepped plots for data values</li>
<li><strong>Hierarchical navigation</strong>: Browse into module instances</li>
<li><strong>Time cursors</strong>: Measure timing relationships</li>
</ul>
<p>To generate waveform data, your testbench typically includes:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="n">$dumpfile</span><span class="p">(</span><span class="s">&quot;simulation.vcd&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// Output file name</span>
<span class="w">    </span><span class="n">$dumpvars</span><span class="p">(</span><span class="mh">0</span><span class="p">,</span><span class="w"> </span><span class="n">testbench</span><span class="p">);</span><span class="w">      </span><span class="c1">// Dump all signals in testbench hierarchy</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>The <code>$dumpvars</code> parameters control what gets captured:</p>
<table>
<thead>
<tr>
<th>Syntax</th>
<th>Effect</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>$dumpvars(0, tb)</code></td>
<td>All signals in tb and all sub-modules</td>
</tr>
<tr>
<td><code>$dumpvars(1, tb)</code></td>
<td>Only signals directly in tb</td>
</tr>
<tr>
<td><code>$dumpvars(0, tb.dut)</code></td>
<td>All signals in dut and sub-modules</td>
</tr>
<tr>
<td><code>$dumpvars(0, tb.dut.alu)</code></td>
<td>Just the alu sub-module</td>
</tr>
</tbody>
</table>
<p>Common waveform viewers:</p>
<ul>
<li><strong>GTKWave</strong>: Free, open source, widely used</li>
<li><strong>ModelSim/Questa</strong>: Built into simulator</li>
<li><strong>Vivado Simulator</strong>: Integrated viewer</li>
<li><strong>WaveTrace</strong>: VS Code extension</li>
<li><strong>Surfer</strong>: Modern open source viewer</li>
</ul>
<h4 id="diagram-waveform-viewer-interface">Diagram: Waveform Viewer Interface</h4>
<iframe src="../../sims/waveform-viewer/main.html" width="100%" height="550px" scrolling="no"></iframe>

<details>
<summary>Waveform Viewer Interface</summary>
<p>Type: microsim</p>
<p>Bloom Level: Apply (L3)
Bloom Verb: Use</p>
<p>Learning Objective: Students will be able to use waveform viewer features including zoom, pan, cursors, and signal selection to analyze simulation results.</p>
<p>Instructional Rationale: Interactive waveform display with standard viewer controls teaches the mental model of waveform analysis that transfers to professional tools.</p>
<p>Canvas Layout:</p>
<ul>
<li>Left: Signal list with hierarchy</li>
<li>Center: Waveform display area</li>
<li>Bottom: Time axis with zoom control</li>
<li>Top: Toolbar with navigation buttons</li>
<li>Side: Measurement display</li>
</ul>
<p>Interactive Elements:</p>
<ul>
<li>Zoom in/out on time axis</li>
<li>Pan left/right</li>
<li>Add/remove signals from view</li>
<li>Place cursors for measurements</li>
<li>Hover for value at time</li>
<li>Click to select time point</li>
<li>Expand bus signals to bits</li>
</ul>
<p>Data Visibility:</p>
<ul>
<li>Signal names and values</li>
<li>Time cursor positions</li>
<li>Delta between cursors</li>
<li>Value at cursor time</li>
<li>Signal transitions</li>
<li>Bus values in hex/decimal</li>
</ul>
<p>Visual Style:</p>
<ul>
<li>Classic waveform viewer appearance</li>
<li>Green/red for 1/0 values</li>
<li>Yellow for unknown (X)</li>
<li>Blue for high-impedance (Z)</li>
<li>Professional, tool-like interface</li>
<li>Responsive to window resize</li>
</ul>
<p>Implementation: p5.js with VCD parser and waveform rendering</p>
</details>
<p>Typical waveform analysis tasks:</p>
<ol>
<li><strong>Verify timing</strong>: Check setup/hold relationships</li>
<li><strong>Trace signals</strong>: Follow data through pipeline stages</li>
<li><strong>Find glitches</strong>: Look for unexpected transitions</li>
<li><strong>Debug logic</strong>: Find where signals take wrong values</li>
<li><strong>Measure latency</strong>: Count cycles from input to output</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Waveform Debugging Strategy</p>
<p>When debugging, start at the output that's wrong and work backward. Add signals to the waveform display as you trace the data path. Eventually, you'll find the point where correct input produces incorrect output—that's your bug location.</p>
</div>
<h2 id="debugging-waveforms-finding-the-bug">Debugging Waveforms: Finding the Bug</h2>
<p><strong>Debugging Waveforms</strong> is the systematic process of using waveform displays to locate and understand design errors. It's part detective work, part pattern recognition, and part stubbornness.</p>
<p>The debugging process:</p>
<ol>
<li><strong>Identify symptom</strong>: What's wrong with the output?</li>
<li><strong>Hypothesize cause</strong>: What could make this happen?</li>
<li><strong>Add signals</strong>: Display relevant internal signals</li>
<li><strong>Trace backward</strong>: Find where correct becomes incorrect</li>
<li><strong>Understand bug</strong>: Why did this happen?</li>
<li><strong>Fix and verify</strong>: Correct the code and re-simulate</li>
</ol>
<p>Common bug patterns visible in waveforms:</p>
<table>
<thead>
<tr>
<th>Pattern</th>
<th>Appears As</th>
<th>Likely Cause</th>
</tr>
</thead>
<tbody>
<tr>
<td>Signal stuck at X</td>
<td>Red/unknown trace</td>
<td>Uninitialized register, unconnected wire</td>
</tr>
<tr>
<td>Signal stuck at 0/1</td>
<td>Flat line</td>
<td>Missing assignment, wrong sensitivity list</td>
</tr>
<tr>
<td>Off-by-one timing</td>
<td>Correct value, wrong cycle</td>
<td>Clock domain error, pipeline miscount</td>
</tr>
<tr>
<td>Glitch</td>
<td>Brief spike</td>
<td>Combinational race, missing register</td>
</tr>
<tr>
<td>Wrong value</td>
<td>Incorrect but stable</td>
<td>Logic error, wrong operator</td>
</tr>
</tbody>
</table>
<p>Example: Debugging a counter that counts incorrectly:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Buggy counter - counts by 2 instead of 1!</span>
<span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">reset</span><span class="p">)</span>
<span class="w">        </span><span class="n">count</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">enable</span><span class="p">)</span>
<span class="w">        </span><span class="n">count</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">2</span><span class="p">;</span><span class="w">  </span><span class="c1">// BUG: Should be + 1</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div>
<p>In the waveform, you'd see count jumping: 0, 2, 4, 6... instead of 0, 1, 2, 3... The waveform makes this pattern immediately obvious, whereas a wrong single value might be missed.</p>
<h4 id="diagram-debug-workflow-visualization">Diagram: Debug Workflow Visualization</h4>
<iframe src="../../sims/debug-workflow/main.html" width="100%" height="550px" scrolling="no"></iframe>

<details>
<summary>Debug Workflow Visualization</summary>
<p>Type: microsim</p>
<p>Bloom Level: Analyze (L4)
Bloom Verb: Examine</p>
<p>Learning Objective: Students will be able to examine waveforms systematically to trace incorrect outputs back to their root cause.</p>
<p>Instructional Rationale: Interactive debugging scenario with guided trace-back process teaches the systematic approach professionals use.</p>
<p>Canvas Layout:</p>
<ul>
<li>Top: Waveform display with bug symptom visible</li>
<li>Center: Signal path diagram showing data flow</li>
<li>Bottom: Hints and guidance panel</li>
<li>Side: Signal selector for adding to view</li>
</ul>
<p>Interactive Elements:</p>
<ul>
<li>Identify the incorrect output</li>
<li>Add internal signals to trace</li>
<li>Follow the data path backward</li>
<li>Find the bug source</li>
<li>View corrected code</li>
<li>Reset for new scenario</li>
</ul>
<p>Data Visibility:</p>
<ul>
<li>Initial waveform showing bug symptom</li>
<li>Internal signals as added</li>
<li>Correct vs incorrect values</li>
<li>Path from source to output</li>
<li>Bug location when found</li>
</ul>
<p>Visual Style:</p>
<ul>
<li>Waveform with error highlighting</li>
<li>Signal path arrows</li>
<li>"Aha!" moment visualization</li>
<li>Before/after comparison</li>
<li>Progressive disclosure</li>
</ul>
<p>Implementation: p5.js with guided debugging tutorial</p>
</details>
<p>Key debugging techniques:</p>
<ol>
<li>
<p><strong>Binary search</strong>: If the design has many stages, add signals in the middle first to narrow down which half has the bug</p>
</li>
<li>
<p><strong>Known pattern</strong>: Apply simple, predictable inputs (like counting pattern) so expected outputs are easy to calculate</p>
</li>
<li>
<p><strong>Reset trace</strong>: Always verify reset works correctly before testing normal operation</p>
</li>
<li>
<p><strong>Edge focus</strong>: Many bugs occur at transitions—state changes, counter rollovers, edge cases</p>
</li>
<li>
<p><strong>Compare to spec</strong>: Have the expected waveform in mind (or on paper) before looking at actual</p>
</li>
</ol>
<div class="admonition warning">
<p class="admonition-title">The Two Most Common Verilog Bugs</p>
<ol>
<li><strong>Wrong sensitivity list</strong>: Combinational block doesn't include all inputs, works in synthesis but not simulation</li>
<li><strong>Blocking vs non-blocking confusion</strong>: Using <code>=</code> instead of <code>&lt;=</code> in sequential logic causes race conditions</li>
</ol>
</div>
<h2 id="synthesis-from-code-to-hardware">Synthesis: From Code to Hardware</h2>
<p><strong>Synthesis</strong> is the process of translating your Verilog RTL code into actual hardware—a netlist of gates, flip-flops, and other primitive elements that can be implemented in an FPGA or ASIC.</p>
<p>The synthesis flow:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code>┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│  Verilog RTL    │────▶│    Synthesis    │────▶│    Gate-Level   │
│  (Your Code)    │     │      Tool       │     │     Netlist     │
└─────────────────┘     └─────────────────┘     └─────────────────┘
                              │
                              ▼
                        ┌─────────────────┐
                        │  Technology     │
                        │    Library      │
                        └─────────────────┘
</code></pre></div></td></tr></table></div>
<p>What synthesis does:</p>
<ol>
<li><strong>Parses</strong> your Verilog code</li>
<li><strong>Infers</strong> hardware structures (registers, muxes, adders)</li>
<li><strong>Optimizes</strong> for area, speed, or power</li>
<li><strong>Maps</strong> to available primitives in the target technology</li>
<li><strong>Outputs</strong> a netlist of connected components</li>
</ol>
<p>Synthesis tools include:</p>
<ul>
<li><strong>Vivado Synthesis</strong> (AMD/Xilinx FPGAs)</li>
<li><strong>Quartus</strong> (Intel FPGAs)</li>
<li><strong>Design Compiler</strong> (Synopsys, for ASICs)</li>
<li><strong>Genus</strong> (Cadence, for ASICs)</li>
<li><strong>Yosys</strong> (Open source)</li>
</ul>
<p>The synthesis tool reads your behavioral Verilog and figures out what hardware to build:</p>
<table>
<thead>
<tr>
<th>You Write</th>
<th>Synthesis Infers</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>assign y = a &amp; b;</code></td>
<td>AND gate</td>
</tr>
<tr>
<td><code>always @(posedge clk) q &lt;= d;</code></td>
<td>D flip-flop</td>
</tr>
<tr>
<td><code>if (sel) y = a; else y = b;</code></td>
<td>Multiplexer</td>
</tr>
<tr>
<td><code>y = a + b;</code></td>
<td>Adder circuit</td>
</tr>
<tr>
<td>FSM with state register</td>
<td>State encoding + logic</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Synthesis Is Not Simulation</p>
<p>Simulation runs your code. Synthesis <em>transforms</em> your code into hardware. Code that simulates correctly might not synthesize correctly (or at all) if it uses non-synthesizable constructs.</p>
</div>
<h2 id="synthesizable-code-what-can-become-hardware">Synthesizable Code: What Can Become Hardware</h2>
<p><strong>Synthesizable Code</strong> is Verilog code that synthesis tools can convert into actual hardware. Not all valid Verilog is synthesizable—some constructs exist only for simulation.</p>
<p>Guidelines for synthesizable code:</p>
<p><strong>Always blocks must have proper sensitivity:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Synthesizable: complete sensitivity</span>
<span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="n">q</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">d</span><span class="p">;</span>
<span class="k">end</span>

<span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="k">end</span>

<span class="c1">// NOT synthesizable: incomplete sensitivity (simulation only)</span>
<span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w">  </span><span class="c1">// What about b?</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Use correct assignment types:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Synthesizable: proper blocking for combinational</span>
<span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">    </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mh">2</span><span class="p">;</span>
<span class="k">end</span>

<span class="c1">// Synthesizable: proper non-blocking for sequential</span>
<span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="n">stage1</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">data_in</span><span class="p">;</span>
<span class="w">    </span><span class="n">stage2</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">stage1</span><span class="p">;</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Avoid latches (unless intentional):</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Creates latch (usually unintended)</span>
<span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">enable</span><span class="p">)</span>
<span class="w">        </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// Missing else - y must hold value</span>
<span class="k">end</span>

<span class="c1">// Fixed: no latch</span>
<span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">enable</span><span class="p">)</span>
<span class="w">        </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">;</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">;</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div></p>
<p>Synthesizable constructs:</p>
<table>
<thead>
<tr>
<th>Construct</th>
<th>Synthesizable</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>module</code>, <code>endmodule</code></td>
<td>Yes</td>
<td>Design hierarchy</td>
</tr>
<tr>
<td><code>input</code>, <code>output</code>, <code>inout</code></td>
<td>Yes</td>
<td>Port declarations</td>
</tr>
<tr>
<td><code>wire</code>, <code>reg</code></td>
<td>Yes</td>
<td>Signal declarations</td>
</tr>
<tr>
<td><code>assign</code></td>
<td>Yes</td>
<td>Combinational logic</td>
</tr>
<tr>
<td><code>always @(posedge clk)</code></td>
<td>Yes</td>
<td>Sequential logic</td>
</tr>
<tr>
<td><code>always @(*)</code></td>
<td>Yes</td>
<td>Combinational logic</td>
</tr>
<tr>
<td><code>if</code>, <code>else</code></td>
<td>Yes</td>
<td>Multiplexers, priority</td>
</tr>
<tr>
<td><code>case</code></td>
<td>Yes</td>
<td>Parallel selection</td>
</tr>
<tr>
<td><code>+</code>, <code>-</code>, <code>*</code></td>
<td>Yes</td>
<td>Arithmetic</td>
</tr>
<tr>
<td><code>&amp;</code>, <code>\|</code>, <code>^</code></td>
<td>Yes</td>
<td>Logic gates</td>
</tr>
<tr>
<td><code>parameter</code>, <code>localparam</code></td>
<td>Yes</td>
<td>Constants</td>
</tr>
<tr>
<td><code>for</code> (with fixed bounds)</td>
<td>Yes</td>
<td>Unrolled at synthesis</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Think Hardware First</p>
<p>Before writing code, ask: "What hardware do I want?" If you can't visualize the gates and flip-flops, reconsider your approach. Synthesizable code describes hardware structures, not algorithms.</p>
</div>
<h2 id="non-synthesizable-code-simulation-only">Non-Synthesizable Code: Simulation Only</h2>
<p><strong>Non-Synthesizable Code</strong> includes Verilog constructs that work in simulation but cannot be translated into hardware. These constructs are essential for testbenches but must be kept out of your design modules.</p>
<p>Common non-synthesizable constructs:</p>
<table>
<thead>
<tr>
<th>Construct</th>
<th>Purpose</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>initial</code></td>
<td>Set starting values</td>
<td><code>initial clk = 0;</code></td>
</tr>
<tr>
<td><code>#</code> delay</td>
<td>Simulation timing</td>
<td><code>#10 a = 1;</code></td>
</tr>
<tr>
<td><code>$display</code>, <code>$write</code></td>
<td>Print messages</td>
<td><code>$display("Hello");</code></td>
</tr>
<tr>
<td><code>$finish</code>, <code>$stop</code></td>
<td>Control simulation</td>
<td><code>#1000 $finish;</code></td>
</tr>
<tr>
<td><code>$random</code></td>
<td>Generate random values</td>
<td><code>data = $random;</code></td>
</tr>
<tr>
<td><code>$time</code>, <code>$realtime</code></td>
<td>Get simulation time</td>
<td><code>$display("T=%0t", $time);</code></td>
</tr>
<tr>
<td><code>$dumpfile</code>, <code>$dumpvars</code></td>
<td>Waveform output</td>
<td><code>$dumpfile("test.vcd");</code></td>
</tr>
<tr>
<td><code>$readmemh</code>, <code>$readmemb</code></td>
<td>Load memory from file</td>
<td><code>$readmemh("data.hex", mem);</code></td>
</tr>
<tr>
<td><code>forever</code></td>
<td>Infinite loop</td>
<td><code>forever #5 clk = ~clk;</code></td>
</tr>
<tr>
<td><code>force</code>, <code>release</code></td>
<td>Override signals</td>
<td><code>force wire_x = 1;</code></td>
</tr>
</tbody>
</table>
<p>These constructs have no hardware equivalent:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Non-synthesizable - only for testbenches!</span>
<span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;Starting simulation...&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">forever</span><span class="w"> </span><span class="p">#</span><span class="mh">5</span><span class="w"> </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">clk</span><span class="p">;</span>
<span class="k">end</span>

<span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">$random</span><span class="p">;</span>
<span class="w">    </span><span class="p">#</span><span class="mh">100</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="n">expected</span><span class="p">)</span>
<span class="w">        </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;ERROR: mismatch at time %0t&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">$time</span><span class="p">);</span>
<span class="w">    </span><span class="nb">$finish</span><span class="p">;</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div>
<h4 id="diagram-synthesizable-vs-non-synthesizable">Diagram: Synthesizable vs Non-Synthesizable</h4>
<iframe src="../../sims/synth-vs-nonsynth/main.html" width="100%" height="500px" scrolling="no"></iframe>

<details>
<summary>Synthesizable vs Non-Synthesizable Code</summary>
<p>Type: infographic</p>
<p>Bloom Level: Evaluate (L5)
Bloom Verb: Classify</p>
<p>Learning Objective: Students will be able to classify Verilog constructs as synthesizable or non-synthesizable, understanding which belong in design modules versus testbenches.</p>
<p>Instructional Rationale: Interactive classification exercise with immediate feedback trains the critical distinction between design code and verification code.</p>
<p>Canvas Layout:</p>
<ul>
<li>Left: Code snippets to classify</li>
<li>Center: Drag zone for synthesizable</li>
<li>Right: Drag zone for non-synthesizable</li>
<li>Bottom: Score and explanation panel</li>
</ul>
<p>Interactive Elements:</p>
<ul>
<li>Drag code snippets to categories</li>
<li>Immediate feedback on correctness</li>
<li>Explanation of why each is/isn't synthesizable</li>
<li>Score tracking</li>
<li>Hint system</li>
<li>Reset for practice</li>
</ul>
<p>Data Visibility:</p>
<ul>
<li>Code snippets</li>
<li>Correct categorization</li>
<li>Explanation for each</li>
<li>Running score</li>
<li>Common mistakes highlighted</li>
</ul>
<p>Visual Style:</p>
<ul>
<li>Clean card-based code snippets</li>
<li>Color feedback (green=correct, red=wrong)</li>
<li>Explanation tooltips</li>
<li>Progress indicator</li>
<li>Responsive layout</li>
</ul>
<p>Implementation: p5.js with drag-and-drop interaction</p>
</details>
<p>The key rule: <strong>Design modules must be synthesizable. Testbenches need not be.</strong></p>
<p>Keep your code organized:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// design.v - Only synthesizable code!</span>
<span class="k">module</span><span class="w"> </span><span class="n">my_design</span><span class="p">(</span>
<span class="w">    </span><span class="k">input</span><span class="w"> </span><span class="n">clk</span><span class="p">,</span><span class="w"> </span><span class="n">reset</span><span class="p">,</span>
<span class="w">    </span><span class="k">input</span><span class="w"> </span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">data_in</span><span class="p">,</span>
<span class="w">    </span><span class="k">output</span><span class="w"> </span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">data_out</span>
<span class="p">);</span>
<span class="w">    </span><span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">reset</span><span class="p">)</span>
<span class="w">            </span><span class="n">data_out</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">8</span><span class="mb">&#39;b0</span><span class="p">;</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">            </span><span class="n">data_out</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">data_in</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">endmodule</span>

<span class="c1">// testbench.v - Non-synthesizable is fine here</span>
<span class="k">module</span><span class="w"> </span><span class="n">testbench</span><span class="p">;</span>
<span class="w">    </span><span class="kt">reg</span><span class="w"> </span><span class="n">clk</span><span class="p">,</span><span class="w"> </span><span class="n">reset</span><span class="p">;</span>
<span class="w">    </span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">data_in</span><span class="p">;</span>
<span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">data_out</span><span class="p">;</span>

<span class="w">    </span><span class="n">my_design</span><span class="w"> </span><span class="n">dut</span><span class="p">(...);</span>

<span class="w">    </span><span class="k">initial</span><span class="w"> </span><span class="k">begin</span><span class="w">  </span><span class="c1">// Non-synthesizable</span>
<span class="w">        </span><span class="n">$dumpfile</span><span class="p">(</span><span class="s">&quot;test.vcd&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">$dumpvars</span><span class="p">(</span><span class="mh">0</span><span class="p">,</span><span class="w"> </span><span class="n">testbench</span><span class="p">);</span>
<span class="w">        </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">        </span><span class="k">forever</span><span class="w"> </span><span class="p">#</span><span class="mh">5</span><span class="w"> </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">clk</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span>

<span class="w">    </span><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">        </span><span class="p">#</span><span class="mh">100</span><span class="w"> </span><span class="nb">$finish</span><span class="p">;</span><span class="w">  </span><span class="c1">// Non-synthesizable</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">endmodule</span>
</code></pre></div></td></tr></table></div>
<div class="admonition warning">
<p class="admonition-title">Don't Mix Design and Testbench</p>
<p>Never put <code>$display</code>, <code>#</code> delays, or <code>initial</code> blocks (except for ROM initialization) in modules you intend to synthesize. Keep simulation-only constructs in separate testbench files.</p>
</div>
<h2 id="bringing-it-all-together-a-complete-verification-example">Bringing It All Together: A Complete Verification Example</h2>
<p>Let's build a complete testbench for a simple FIFO (First-In-First-Out) buffer:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">//============================================</span>
<span class="c1">// FIFO Design (Synthesizable)</span>
<span class="c1">//============================================</span>
<span class="k">module</span><span class="w"> </span><span class="n">fifo</span><span class="w"> </span><span class="p">#(</span>
<span class="w">    </span><span class="k">parameter</span><span class="w"> </span><span class="n">WIDTH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">8</span><span class="p">,</span>
<span class="w">    </span><span class="k">parameter</span><span class="w"> </span><span class="n">DEPTH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">4</span>
<span class="p">)(</span>
<span class="w">    </span><span class="k">input</span><span class="w">                  </span><span class="n">clk</span><span class="p">,</span>
<span class="w">    </span><span class="k">input</span><span class="w">                  </span><span class="n">reset</span><span class="p">,</span>
<span class="w">    </span><span class="k">input</span><span class="w">                  </span><span class="n">wr_en</span><span class="p">,</span>
<span class="w">    </span><span class="k">input</span><span class="w">                  </span><span class="n">rd_en</span><span class="p">,</span>
<span class="w">    </span><span class="k">input</span><span class="w">      </span><span class="p">[</span><span class="n">WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">wr_data</span><span class="p">,</span>
<span class="w">    </span><span class="k">output</span><span class="w"> </span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="n">WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">rd_data</span><span class="p">,</span>
<span class="w">    </span><span class="k">output</span><span class="w">                 </span><span class="n">full</span><span class="p">,</span>
<span class="w">    </span><span class="k">output</span><span class="w">                 </span><span class="n">empty</span>
<span class="p">);</span>

<span class="w">    </span><span class="c1">// Memory and pointers</span>
<span class="w">    </span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="n">WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">mem</span><span class="w"> </span><span class="p">[</span><span class="mh">0</span><span class="o">:</span><span class="n">DEPTH</span><span class="o">-</span><span class="mh">1</span><span class="p">];</span>
<span class="w">    </span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="n">$clog2</span><span class="p">(</span><span class="n">DEPTH</span><span class="p">)</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">wr_ptr</span><span class="p">,</span><span class="w"> </span><span class="n">rd_ptr</span><span class="p">;</span><span class="w">  </span><span class="c1">// Extra bit for full/empty detection</span>

<span class="w">    </span><span class="c1">// Full/empty logic</span>
<span class="w">    </span><span class="k">assign</span><span class="w"> </span><span class="n">full</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">wr_ptr</span><span class="p">[</span><span class="n">$clog2</span><span class="p">(</span><span class="n">DEPTH</span><span class="p">)]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">rd_ptr</span><span class="p">[</span><span class="n">$clog2</span><span class="p">(</span><span class="n">DEPTH</span><span class="p">)])</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">                   </span><span class="p">(</span><span class="n">wr_ptr</span><span class="p">[</span><span class="n">$clog2</span><span class="p">(</span><span class="n">DEPTH</span><span class="p">)</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">rd_ptr</span><span class="p">[</span><span class="n">$clog2</span><span class="p">(</span><span class="n">DEPTH</span><span class="p">)</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]);</span>
<span class="w">    </span><span class="k">assign</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">wr_ptr</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">rd_ptr</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Write logic</span>
<span class="w">    </span><span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">reset</span><span class="p">)</span>
<span class="w">            </span><span class="n">wr_ptr</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">wr_en</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">full</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="n">mem</span><span class="p">[</span><span class="n">wr_ptr</span><span class="p">[</span><span class="n">$clog2</span><span class="p">(</span><span class="n">DEPTH</span><span class="p">)</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">wr_data</span><span class="p">;</span>
<span class="w">            </span><span class="n">wr_ptr</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">wr_ptr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>

<span class="w">    </span><span class="c1">// Read logic</span>
<span class="w">    </span><span class="k">always</span><span class="w"> </span><span class="p">@(</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">reset</span><span class="p">)</span>
<span class="w">            </span><span class="n">rd_ptr</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rd_en</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">empty</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="n">rd_data</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">mem</span><span class="p">[</span><span class="n">rd_ptr</span><span class="p">[</span><span class="n">$clog2</span><span class="p">(</span><span class="n">DEPTH</span><span class="p">)</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]];</span>
<span class="w">            </span><span class="n">rd_ptr</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">rd_ptr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">    </span><span class="k">end</span>

<span class="k">endmodule</span>

<span class="c1">//============================================</span>
<span class="c1">// FIFO Testbench (Non-Synthesizable)</span>
<span class="c1">//============================================</span>
<span class="no">`timescale</span><span class="w"> </span><span class="mh">1</span><span class="n">ns</span><span class="o">/</span><span class="mh">1</span><span class="n">ps</span>

<span class="k">module</span><span class="w"> </span><span class="n">fifo_tb</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Parameters</span>
<span class="w">    </span><span class="k">parameter</span><span class="w"> </span><span class="n">WIDTH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">8</span><span class="p">;</span>
<span class="w">    </span><span class="k">parameter</span><span class="w"> </span><span class="n">DEPTH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">4</span><span class="p">;</span>
<span class="w">    </span><span class="k">parameter</span><span class="w"> </span><span class="n">CLK_PERIOD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">10</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Testbench signals</span>
<span class="w">    </span><span class="kt">reg</span><span class="w">                  </span><span class="n">clk</span><span class="p">;</span>
<span class="w">    </span><span class="kt">reg</span><span class="w">                  </span><span class="n">reset</span><span class="p">;</span>
<span class="w">    </span><span class="kt">reg</span><span class="w">                  </span><span class="n">wr_en</span><span class="p">;</span>
<span class="w">    </span><span class="kt">reg</span><span class="w">                  </span><span class="n">rd_en</span><span class="p">;</span>
<span class="w">    </span><span class="kt">reg</span><span class="w">      </span><span class="p">[</span><span class="n">WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">wr_data</span><span class="p">;</span>
<span class="w">    </span><span class="kt">wire</span><span class="w">     </span><span class="p">[</span><span class="n">WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">rd_data</span><span class="p">;</span>
<span class="w">    </span><span class="kt">wire</span><span class="w">                 </span><span class="n">full</span><span class="p">;</span>
<span class="w">    </span><span class="kt">wire</span><span class="w">                 </span><span class="n">empty</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// For self-checking</span>
<span class="w">    </span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="n">WIDTH</span><span class="o">-</span><span class="mh">1</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">expected_data</span><span class="w"> </span><span class="p">[</span><span class="mh">0</span><span class="o">:</span><span class="n">DEPTH</span><span class="o">-</span><span class="mh">1</span><span class="p">];</span>
<span class="w">    </span><span class="k">integer</span><span class="w"> </span><span class="n">wr_count</span><span class="p">,</span><span class="w"> </span><span class="n">rd_count</span><span class="p">,</span><span class="w"> </span><span class="n">errors</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Instantiate DUT</span>
<span class="w">    </span><span class="n">fifo</span><span class="w"> </span><span class="p">#(.</span><span class="n">WIDTH</span><span class="p">(</span><span class="n">WIDTH</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">DEPTH</span><span class="p">(</span><span class="n">DEPTH</span><span class="p">))</span><span class="w"> </span><span class="n">dut</span><span class="p">(</span>
<span class="w">        </span><span class="p">.</span><span class="n">clk</span><span class="p">(</span><span class="n">clk</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">reset</span><span class="p">(</span><span class="n">reset</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">wr_en</span><span class="p">(</span><span class="n">wr_en</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">rd_en</span><span class="p">(</span><span class="n">rd_en</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">wr_data</span><span class="p">(</span><span class="n">wr_data</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">rd_data</span><span class="p">(</span><span class="n">rd_data</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">full</span><span class="p">(</span><span class="n">full</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">empty</span><span class="p">(</span><span class="n">empty</span><span class="p">)</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Clock generation</span>
<span class="w">    </span><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">        </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">        </span><span class="k">forever</span><span class="w"> </span><span class="p">#(</span><span class="n">CLK_PERIOD</span><span class="o">/</span><span class="mh">2</span><span class="p">)</span><span class="w"> </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">clk</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span>

<span class="w">    </span><span class="c1">// Waveform dump</span>
<span class="w">    </span><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">        </span><span class="n">$dumpfile</span><span class="p">(</span><span class="s">&quot;fifo_tb.vcd&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">$dumpvars</span><span class="p">(</span><span class="mh">0</span><span class="p">,</span><span class="w"> </span><span class="n">fifo_tb</span><span class="p">);</span>
<span class="w">    </span><span class="k">end</span>

<span class="w">    </span><span class="c1">// Main test sequence</span>
<span class="w">    </span><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">        </span><span class="c1">// Initialize</span>
<span class="w">        </span><span class="n">reset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span>
<span class="w">        </span><span class="n">wr_en</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">        </span><span class="n">rd_en</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">        </span><span class="n">wr_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">        </span><span class="n">wr_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">        </span><span class="n">rd_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">        </span><span class="n">errors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// Wait for reset</span>
<span class="w">        </span><span class="k">repeat</span><span class="p">(</span><span class="mh">3</span><span class="p">)</span><span class="w"> </span><span class="p">@(</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">);</span>
<span class="w">        </span><span class="n">reset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">        </span><span class="p">@(</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Test 1: Verify empty after reset</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">empty</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;ERROR: FIFO not empty after reset!&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">errors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">errors</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span>
<span class="w">        </span><span class="k">end</span>

<span class="w">        </span><span class="c1">// Test 2: Write until full</span>
<span class="w">        </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">=== Test 2: Fill FIFO ===&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">full</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="p">@(</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">);</span>
<span class="w">            </span><span class="n">wr_en</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span>
<span class="w">            </span><span class="n">wr_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">$random</span><span class="p">;</span>
<span class="w">            </span><span class="n">expected_data</span><span class="p">[</span><span class="n">wr_count</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">DEPTH</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wr_data</span><span class="p">;</span>
<span class="w">            </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;  Writing: %h&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">wr_data</span><span class="p">);</span>
<span class="w">            </span><span class="n">wr_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wr_count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">        </span><span class="p">@(</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">);</span>
<span class="w">        </span><span class="n">wr_en</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// Verify full</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">full</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;ERROR: FIFO not full after %d writes!&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">wr_count</span><span class="p">);</span>
<span class="w">            </span><span class="n">errors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">errors</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span>
<span class="w">        </span><span class="k">end</span>

<span class="w">        </span><span class="c1">// Test 3: Read and verify data</span>
<span class="w">        </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">=== Test 3: Read and Verify ===&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">empty</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="p">@(</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">);</span>
<span class="w">            </span><span class="n">rd_en</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">        </span><span class="p">@(</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">);</span>
<span class="w">        </span><span class="n">rd_en</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// Wait for last read to complete</span>
<span class="w">        </span><span class="p">@(</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Test 4: Mixed read/write</span>
<span class="w">        </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">=== Test 4: Mixed Operations ===&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">repeat</span><span class="p">(</span><span class="mh">20</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="p">@(</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">);</span>
<span class="w">            </span><span class="n">wr_en</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nb">$random</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mh">2</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">full</span><span class="p">;</span>
<span class="w">            </span><span class="n">rd_en</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nb">$random</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mh">2</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">empty</span><span class="p">;</span>
<span class="w">            </span><span class="n">wr_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">$random</span><span class="p">;</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">wr_en</span><span class="p">)</span>
<span class="w">                </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;  Write: %h&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">wr_data</span><span class="p">);</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rd_en</span><span class="p">)</span>
<span class="w">                </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;  Read: %h&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">rd_data</span><span class="p">);</span>
<span class="w">        </span><span class="k">end</span>
<span class="w">        </span><span class="p">@(</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">);</span>
<span class="w">        </span><span class="n">wr_en</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">        </span><span class="n">rd_en</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// Final report</span>
<span class="w">        </span><span class="k">repeat</span><span class="p">(</span><span class="mh">5</span><span class="p">)</span><span class="w"> </span><span class="p">@(</span><span class="k">posedge</span><span class="w"> </span><span class="n">clk</span><span class="p">);</span>
<span class="w">        </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">========================================&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">errors</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0</span><span class="p">)</span>
<span class="w">            </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;SUCCESS: All tests passed!&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">            </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;FAILED: %d errors detected&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">errors</span><span class="p">);</span>
<span class="w">        </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;========================================</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="nb">$finish</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span>

<span class="w">    </span><span class="c1">// Timeout watchdog</span>
<span class="w">    </span><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">        </span><span class="p">#</span><span class="mh">10000</span><span class="p">;</span>
<span class="w">        </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;ERROR: Simulation timeout!&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="nb">$finish</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span>

<span class="k">endmodule</span>
</code></pre></div></td></tr></table></div>
<p>This testbench demonstrates:</p>
<ul>
<li>Clock generation with parameterized period</li>
<li>Reset sequence</li>
<li>Multiple test phases</li>
<li>Random stimulus</li>
<li>Self-checking logic</li>
<li>Waveform generation</li>
<li>Timeout protection</li>
<li>Clear pass/fail reporting</li>
</ul>
<h2 id="summary-and-key-takeaways">Summary and Key Takeaways</h2>
<p>Congratulations! You've learned the essential skills of digital design verification. Let's recap the key points:</p>
<p><strong>Testbench Fundamentals:</strong></p>
<ul>
<li>Testbenches are non-synthesizable modules that test your design</li>
<li>They provide stimulus, generate clocks, and observe outputs</li>
<li>The DUT (Device Under Test) is instantiated inside the testbench</li>
</ul>
<p><strong>Stimulus and Vectors:</strong></p>
<ul>
<li>Generate stimulus through direct assignment, loops, random, or files</li>
<li>Test vectors organize inputs and expected outputs</li>
<li>Cover edge cases, boundaries, and error conditions</li>
</ul>
<p><strong>Clock and Timing:</strong></p>
<ul>
<li>Generate clocks with <code>initial</code> and <code>forever</code> blocks</li>
<li>Use <code>#</code> delays for timing control</li>
<li>Be careful about clock-data alignment (add small delays)</li>
</ul>
<p><strong>Self-Checking:</strong></p>
<ul>
<li>Compare DUT outputs against expected values automatically</li>
<li>Use error counters and summary reports</li>
<li>Reference models help verify complex logic</li>
</ul>
<p><strong>Simulation:</strong></p>
<ul>
<li>Simulators execute your design in virtual time</li>
<li>Use <code>$dumpfile</code> and <code>$dumpvars</code> for waveforms</li>
<li>Waveform viewers are essential for debugging</li>
</ul>
<p><strong>Synthesizable Code:</strong></p>
<ul>
<li>Only synthesizable constructs go in design modules</li>
<li><code>initial</code>, <code>#</code> delays, and <code>$</code> tasks are simulation only</li>
<li>Keep testbench code separate from design code</li>
</ul>
<div class="admonition success">
<p class="admonition-title">The Verification Mindset</p>
<p>Think of yourself as trying to break your design, not prove it works. Every test that passes without finding a bug is a missed opportunity. The goal isn't to write tests that pass—it's to write tests that would <em>fail</em> if the design had a bug.</p>
</div>
<details>
<summary>Graphic Novel Suggestion</summary>
<p>An engaging graphic novel could follow the dramatic story of the Pentium FDIV bug of 1994, where a flaw in Intel's Pentium processor's floating-point division unit caused incorrect calculations. The narrative could show the verification engineers who—in hindsight—see where additional test vectors might have caught the bug. The tension builds as the bug is discovered by a mathematics professor, Intel initially dismisses it, and the eventual recall costs $475 million. The moral: "Every test you don't run is a bug you might not find." The story could end with modern verification practices that emerged from this disaster, showing how the industry transformed testing from an afterthought to a primary engineering discipline.</p>
</details>
<h2 id="practice-problems">Practice Problems</h2>
<p>Test your understanding with these exercises:</p>
<details class="question">
<summary>Problem 1: Testbench Structure</summary>
<p>What's wrong with this testbench?
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">module</span><span class="w"> </span><span class="n">my_tb</span><span class="p">(</span>
<span class="w">    </span><span class="k">output</span><span class="w"> </span><span class="kt">reg</span><span class="w"> </span><span class="n">clk</span><span class="p">,</span>
<span class="w">    </span><span class="k">output</span><span class="w"> </span><span class="kt">reg</span><span class="w"> </span><span class="n">reset</span>
<span class="p">);</span>
<span class="w">    </span><span class="n">my_design</span><span class="w"> </span><span class="n">dut</span><span class="p">(.</span><span class="n">clk</span><span class="p">(</span><span class="n">clk</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">reset</span><span class="p">(</span><span class="n">reset</span><span class="p">));</span>

<span class="w">    </span><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">        </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">        </span><span class="k">forever</span><span class="w"> </span><span class="p">#</span><span class="mh">5</span><span class="w"> </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">clk</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">endmodule</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Solution:</strong>
Testbenches should NOT have a port list! They are self-contained top-level modules. The <code>output reg clk</code> and <code>output reg reset</code> declarations are wrong. Fix:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">module</span><span class="w"> </span><span class="n">my_tb</span><span class="p">;</span><span class="w">  </span><span class="c1">// No ports!</span>
<span class="w">    </span><span class="kt">reg</span><span class="w"> </span><span class="n">clk</span><span class="p">;</span>
<span class="w">    </span><span class="kt">reg</span><span class="w"> </span><span class="n">reset</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// ...</span>
</code></pre></div></td></tr></table></div></p>
</details>
<details class="question">
<summary>Problem 2: Clock Generation</summary>
<p>Write clock generation code for a 50 MHz clock (20ns period).</p>
<p><strong>Solution:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">parameter</span><span class="w"> </span><span class="n">CLK_PERIOD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">20</span><span class="p">;</span><span class="w">  </span><span class="c1">// 20ns = 50 MHz</span>

<span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">forever</span><span class="w"> </span><span class="p">#(</span><span class="n">CLK_PERIOD</span><span class="o">/</span><span class="mh">2</span><span class="p">)</span><span class="w"> </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">clk</span><span class="p">;</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div>
Or more explicitly:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">forever</span><span class="w"> </span><span class="p">#</span><span class="mh">10</span><span class="w"> </span><span class="n">clk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">clk</span><span class="p">;</span><span class="w">  </span><span class="c1">// 10ns high, 10ns low = 20ns period</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div></p>
</details>
<details class="question">
<summary>Problem 3: Self-Checking Logic</summary>
<p>Add self-checking to verify this AND gate:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">module</span><span class="w"> </span><span class="n">and_gate_tb</span><span class="p">;</span>
<span class="w">    </span><span class="kt">reg</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="n">y</span><span class="p">;</span>

<span class="w">    </span><span class="n">and_gate</span><span class="w"> </span><span class="n">dut</span><span class="p">(.</span><span class="n">a</span><span class="p">(</span><span class="n">a</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">b</span><span class="p">(</span><span class="n">b</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">y</span><span class="p">(</span><span class="n">y</span><span class="p">));</span>

<span class="w">    </span><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">        </span><span class="c1">// Test all input combinations</span>
<span class="w">        </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"> </span><span class="p">#</span><span class="mh">10</span><span class="p">;</span>
<span class="w">        </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span><span class="w"> </span><span class="p">#</span><span class="mh">10</span><span class="p">;</span>
<span class="w">        </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"> </span><span class="p">#</span><span class="mh">10</span><span class="p">;</span>
<span class="w">        </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span><span class="w"> </span><span class="p">#</span><span class="mh">10</span><span class="p">;</span>
<span class="w">        </span><span class="nb">$finish</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">endmodule</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Solution:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">module</span><span class="w"> </span><span class="n">and_gate_tb</span><span class="p">;</span>
<span class="w">    </span><span class="kt">reg</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="n">y</span><span class="p">;</span>
<span class="w">    </span><span class="k">integer</span><span class="w"> </span><span class="n">errors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>

<span class="w">    </span><span class="n">and_gate</span><span class="w"> </span><span class="n">dut</span><span class="p">(.</span><span class="n">a</span><span class="p">(</span><span class="n">a</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">b</span><span class="p">(</span><span class="n">b</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">y</span><span class="p">(</span><span class="n">y</span><span class="p">));</span>

<span class="w">    </span><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">        </span><span class="c1">// Test all input combinations</span>
<span class="w">        </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"> </span><span class="p">#</span><span class="mh">10</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="mh">0</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span><span class="w"> </span><span class="n">errors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">errors</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span><span class="w"> </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;FAIL: 0&amp;0&quot;</span><span class="p">);</span><span class="w"> </span><span class="k">end</span>

<span class="w">        </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span><span class="w"> </span><span class="p">#</span><span class="mh">10</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="mh">0</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span><span class="w"> </span><span class="n">errors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">errors</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span><span class="w"> </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;FAIL: 0&amp;1&quot;</span><span class="p">);</span><span class="w"> </span><span class="k">end</span>

<span class="w">        </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"> </span><span class="p">#</span><span class="mh">10</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="mh">0</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span><span class="w"> </span><span class="n">errors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">errors</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span><span class="w"> </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;FAIL: 1&amp;0&quot;</span><span class="p">);</span><span class="w"> </span><span class="k">end</span>

<span class="w">        </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span><span class="w"> </span><span class="p">#</span><span class="mh">10</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="mh">1</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span><span class="w"> </span><span class="n">errors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">errors</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span><span class="w"> </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;FAIL: 1&amp;1&quot;</span><span class="p">);</span><span class="w"> </span><span class="k">end</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">errors</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0</span><span class="p">)</span>
<span class="w">            </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;PASS: All tests passed&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">            </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;FAIL: %d errors&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">errors</span><span class="p">);</span>
<span class="w">        </span><span class="nb">$finish</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span>
<span class="k">endmodule</span>
</code></pre></div></td></tr></table></div></p>
</details>
<details class="question">
<summary>Problem 4: Synthesizable Check</summary>
<p>Which of these code fragments are synthesizable?</p>
<p>A) <code>initial q = 0;</code>
B) <code>always @(posedge clk) q &lt;= d;</code>
C) <code>#10 a = 1;</code>
D) <code>assign y = a &amp; b;</code>
E) <code>$display("Value: %d", x);</code></p>
<p><strong>Solution:</strong>
- A) <strong>Generally No</strong> (some FPGAs support for initialization, but not portable)
- B) <strong>Yes</strong> (D flip-flop)
- C) <strong>No</strong> (<code>#</code> delays are simulation only)
- D) <strong>Yes</strong> (AND gate)
- E) <strong>No</strong> (<code>$display</code> is simulation only)</p>
</details>
<details class="question">
<summary>Problem 5: Debug Scenario</summary>
<p>Your counter counts 0, 2, 4, 6 instead of 0, 1, 2, 3. What bug would you look for in the waveform?</p>
<p><strong>Solution:</strong>
Look for:
1. The increment value - it's probably <code>count + 2</code> instead of <code>count + 1</code>
2. Double clock edges - maybe posedge AND negedge triggering
3. Enable signal toggling at unexpected times
4. Count register being loaded from wrong source</p>
<p>In the waveform, trace the count value backward to the increment operation to find the wrong constant or the clock issue.</p>
</details>
<details class="question">
<summary>Problem 6: Test Vector Design</summary>
<p>Design test vectors for a 2-bit comparator with outputs <code>eq</code> (equal), <code>lt</code> (less than), <code>gt</code> (greater than).</p>
<p><strong>Solution:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Test vectors: {a[1:0], b[1:0], expected_eq, expected_lt, expected_gt}</span>
<span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">6</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">vectors</span><span class="w"> </span><span class="p">[</span><span class="mh">0</span><span class="o">:</span><span class="mh">15</span><span class="p">];</span>

<span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">    </span><span class="c1">// All combinations of 2-bit inputs</span>
<span class="w">    </span><span class="n">vectors</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b00</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b00</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">};</span><span class="w">  </span><span class="c1">// 0 == 0</span>
<span class="w">    </span><span class="n">vectors</span><span class="p">[</span><span class="mh">1</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b00</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b01</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">};</span><span class="w">  </span><span class="c1">// 0 &lt; 1</span>
<span class="w">    </span><span class="n">vectors</span><span class="p">[</span><span class="mh">2</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b00</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b10</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">};</span><span class="w">  </span><span class="c1">// 0 &lt; 2</span>
<span class="w">    </span><span class="n">vectors</span><span class="p">[</span><span class="mh">3</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b00</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b11</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">};</span><span class="w">  </span><span class="c1">// 0 &lt; 3</span>
<span class="w">    </span><span class="n">vectors</span><span class="p">[</span><span class="mh">4</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b01</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b00</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">};</span><span class="w">  </span><span class="c1">// 1 &gt; 0</span>
<span class="w">    </span><span class="n">vectors</span><span class="p">[</span><span class="mh">5</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b01</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b01</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">};</span><span class="w">  </span><span class="c1">// 1 == 1</span>
<span class="w">    </span><span class="n">vectors</span><span class="p">[</span><span class="mh">6</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b01</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b10</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">};</span><span class="w">  </span><span class="c1">// 1 &lt; 2</span>
<span class="w">    </span><span class="n">vectors</span><span class="p">[</span><span class="mh">7</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b01</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b11</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">};</span><span class="w">  </span><span class="c1">// 1 &lt; 3</span>
<span class="w">    </span><span class="n">vectors</span><span class="p">[</span><span class="mh">8</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b10</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b00</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">};</span><span class="w">  </span><span class="c1">// 2 &gt; 0</span>
<span class="w">    </span><span class="n">vectors</span><span class="p">[</span><span class="mh">9</span><span class="p">]</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b10</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b01</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">};</span><span class="w">  </span><span class="c1">// 2 &gt; 1</span>
<span class="w">    </span><span class="n">vectors</span><span class="p">[</span><span class="mh">10</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b10</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b10</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">};</span><span class="w">  </span><span class="c1">// 2 == 2</span>
<span class="w">    </span><span class="n">vectors</span><span class="p">[</span><span class="mh">11</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b10</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b11</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">};</span><span class="w">  </span><span class="c1">// 2 &lt; 3</span>
<span class="w">    </span><span class="n">vectors</span><span class="p">[</span><span class="mh">12</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b11</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b00</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">};</span><span class="w">  </span><span class="c1">// 3 &gt; 0</span>
<span class="w">    </span><span class="n">vectors</span><span class="p">[</span><span class="mh">13</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b11</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b01</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">};</span><span class="w">  </span><span class="c1">// 3 &gt; 1</span>
<span class="w">    </span><span class="n">vectors</span><span class="p">[</span><span class="mh">14</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b11</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b10</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">};</span><span class="w">  </span><span class="c1">// 3 &gt; 2</span>
<span class="w">    </span><span class="n">vectors</span><span class="p">[</span><span class="mh">15</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">2</span><span class="mb">&#39;b11</span><span class="p">,</span><span class="w"> </span><span class="mh">2</span><span class="mb">&#39;b11</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b1</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">,</span><span class="w"> </span><span class="mh">1</span><span class="mb">&#39;b0</span><span class="p">};</span><span class="w">  </span><span class="c1">// 3 == 3</span>
<span class="k">end</span>
</code></pre></div></td></tr></table></div></p>
</details>
<details class="question">
<summary>Problem 7: Complete Testbench</summary>
<p>Write a complete self-checking testbench for a 4-bit binary to BCD converter. The module converts binary 0-9 to BCD, and outputs 9 for inputs &gt; 9.</p>
<p><strong>Solution:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="no">`timescale</span><span class="w"> </span><span class="mh">1</span><span class="n">ns</span><span class="o">/</span><span class="mh">1</span><span class="n">ps</span>

<span class="k">module</span><span class="w"> </span><span class="n">bin_to_bcd_tb</span><span class="p">;</span>
<span class="w">    </span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">bin</span><span class="p">;</span>
<span class="w">    </span><span class="kt">wire</span><span class="w"> </span><span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">bcd</span><span class="p">;</span>
<span class="w">    </span><span class="k">integer</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">errors</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Expected BCD values</span>
<span class="w">    </span><span class="kt">reg</span><span class="w"> </span><span class="p">[</span><span class="mh">3</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span><span class="w"> </span><span class="n">expected</span><span class="w"> </span><span class="p">[</span><span class="mh">0</span><span class="o">:</span><span class="mh">15</span><span class="p">];</span>

<span class="w">    </span><span class="c1">// DUT</span>
<span class="w">    </span><span class="n">bin_to_bcd</span><span class="w"> </span><span class="n">dut</span><span class="p">(.</span><span class="n">bin</span><span class="p">(</span><span class="n">bin</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">bcd</span><span class="p">(</span><span class="n">bcd</span><span class="p">));</span>

<span class="w">    </span><span class="c1">// Initialize expected values</span>
<span class="w">    </span><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">9</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">)</span>
<span class="w">            </span><span class="n">expected</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">15</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">)</span>
<span class="w">            </span><span class="n">expected</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">9</span><span class="p">;</span><span class="w">  </span><span class="c1">// Saturate at 9</span>
<span class="w">    </span><span class="k">end</span>

<span class="w">    </span><span class="c1">// Test all values</span>
<span class="w">    </span><span class="k">initial</span><span class="w"> </span><span class="k">begin</span>
<span class="w">        </span><span class="n">$dumpfile</span><span class="p">(</span><span class="s">&quot;bin_to_bcd_tb.vcd&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">$dumpvars</span><span class="p">(</span><span class="mh">0</span><span class="p">,</span><span class="w"> </span><span class="n">bin_to_bcd_tb</span><span class="p">);</span>

<span class="w">        </span><span class="n">errors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mh">15</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">)</span><span class="w"> </span><span class="k">begin</span>
<span class="w">            </span><span class="n">bin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">            </span><span class="p">#</span><span class="mh">10</span><span class="p">;</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bcd</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="n">expected</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="k">begin</span>
<span class="w">                </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;ERROR: bin=%d, expected bcd=%d, got=%d&quot;</span><span class="p">,</span>
<span class="w">                         </span><span class="n">bin</span><span class="p">,</span><span class="w"> </span><span class="n">expected</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">bcd</span><span class="p">);</span>
<span class="w">                </span><span class="n">errors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">errors</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">1</span><span class="p">;</span>
<span class="w">            </span><span class="k">end</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">begin</span>
<span class="w">                </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;PASS: bin=%d -&gt; bcd=%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">bin</span><span class="p">,</span><span class="w"> </span><span class="n">bcd</span><span class="p">);</span>
<span class="w">            </span><span class="k">end</span>
<span class="w">        </span><span class="k">end</span>

<span class="w">        </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">========================================&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">errors</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0</span><span class="p">)</span>
<span class="w">            </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;SUCCESS: All 16 tests passed!&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">else</span>
<span class="w">            </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;FAILED: %d errors&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">errors</span><span class="p">);</span>
<span class="w">        </span><span class="nb">$display</span><span class="p">(</span><span class="s">&quot;========================================&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="nb">$finish</span><span class="p">;</span>
<span class="w">    </span><span class="k">end</span>

<span class="k">endmodule</span>
</code></pre></div></td></tr></table></div></p>
</details>
<p><a href="references/">See Annotated References</a></p>







  
  



  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../13-verilog-modeling/references/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Annotated References">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Annotated References
              </div>
            </div>
          </a>
        
        
          
          <a href="quiz/" class="md-footer__link md-footer__link--next" aria-label="Next: Quiz">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Quiz
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2026 Dan McCreary. Licensed under <a href="license/">CC BY-NC-SA 4.0</a> for non-commercial use.
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "navigation.expand", "navigation.path", "navigation.prune", "navigation.indexes", "toc.follow", "navigation.top", "navigation.footer"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../js/extra.js"></script>
      
        <script src="../../js/katex.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>